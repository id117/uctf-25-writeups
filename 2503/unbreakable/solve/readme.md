При инициализации random используется время, причем округленное.
После создания файла, в него дописывается временная метка, зная которую, можно перебрать диапазон значений, находящихся рядом с ней, восстановить ключ и расшифровать файл.